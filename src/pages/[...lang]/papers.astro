---
import Footer from "@/components/Footer.astro";
import Header from "@/components/Header/index.astro";
import Layout from "@/layouts/Layout.astro";
import { useTranslations } from "@/lib/i18n";
import { DEFAULT_LOCALE, LOCALES, isLocale } from "@/lib/locales";
import { papers } from "@/lib/papers";

export async function getStaticPaths() {
  return [
    { params: { lang: undefined } }, // → `/papers` (default locale)
    { params: { lang: "en" } }, // → `/en/papers`
    { params: { lang: "ja" } }, // → `/ja/papers`
  ];
}

const raw = Astro.params.lang;
const lang = isLocale(raw) ? raw : DEFAULT_LOCALE; // fallback to default locale
const t = useTranslations(lang);
---

<Layout>
  <Header />

  <main class="container mx-auto px-4 py-10">
    <h1 class="text-3xl font-bold tracking-tight text-gray-900 mb-6">{t('papers.title')}</h1>

    <p class="text-gray-600 mb-6">{t('papers.description')}</p>

    {papers.length === 0 ? (
      <p class="text-gray-600">{lang === 'ja' ? '関連論文はまだ登録されていません。' : 'No papers listed yet.'}</p>
    ) : (
      <ul class="space-y-6">
        {papers.map((p) => (
          <li class="p-5 rounded-md border border-gray-200 bg-white shadow-sm">
            <div class="text-lg font-semibold text-gray-900">{p.title}</div>
            <div class="text-sm text-gray-700 mt-1">{p.authors}</div>
            <div class="text-sm text-gray-500 mt-1">
              {(p.venue || "").toString()} {p.year ? `(${p.year})` : ""}
            </div>
            {p.url && (
              <div class="mt-3">
                  <a href={p.url} target="_blank" rel="noopener noreferrer" class="hover:underline">
                    {lang === 'ja' ? '論文を読む' : 'View paper'}
                  </a>
              </div>
            )}
          </li>
        ))}
      </ul>
    )}
  </main>

  <Footer />
</Layout>